/*!
ninja.autocomplete 1.1.2
http://ninjaui.com/autocomplete
Copyright 2008-2012 Jamie Hoover
Licensed per the terms of the Apache License v2.0
http://ninjaui.com/license.txt
*/
(function(a){"use strict",a.Ninja.Autocomplete=function(b,c){this.$wrapper=a(b).wrap('<span class="nui-atc">').parent(),this.$list=a("<div>",{css:{top:this.$wrapper.height()-2}}),this.datalist=[],this.matchlist=[],c&&c.get&&(this.get=c.get),this.index=-1},a.Ninja.Autocomplete.prototype.last=function(){return this.matchlist.length-1},a.Ninja.Autocomplete.prototype.list=function(b){var c=this;a.isFunction(c.get)?c.matchlist=b:c.matchlist=a.map(b,function(a){var b=c.$element.val();return b!==a&&(new RegExp("^"+b,"i")).test(a)?a:null}),c.$list.empty(),c.matchlist.length>0&&(a.each(c.matchlist,function(){var b=this;a("<div>",{html:b}).on("hover.ninja",function(){a(this).toggleClass("nui-hvr")}).on("mousedown.ninja",function(){c.$element.val(b)}).appendTo(c.$list)}),c.index=-1,c.$list.appendTo(c.$wrapper))},a.ninja.autocomplete=function(b,c){var d=a.extend(new a.Ninja(b,c),new a.Ninja.Autocomplete(b,c));c&&c.datalist?d.datalist=c.datalist:d.$element.data("list")?d.datalist=d.$element.data("list"):d.$element.attr("list")&&a("datalist#"+d.$element.attr("list")).find("option").each(function(){d.datalist.push(a(this).val())}),d.$element.attr({autocomplete:"off"}).removeAttr("list"),d.$element.on("blur.ninja",function(){d.$list.remove()}),d.$element.on("keydown.ninja",function(b){var c=b.which;a.ninja.key(c,["escape","tab"])?d.$list.remove():c===a.ninja.keys.enter&&d.index>-1?d.$element.val(d.matchlist[d.index]).blur():a.ninja.key(c,["arrowDown","arrowUp"])&&(d.index>-1&&d.$list.find(":eq("+d.index+")").removeClass("nui-hvr"),c===a.ninja.keys.arrowDown?d.index===d.last()?d.index=0:d.index+=1:d.index<=0?d.index=d.last():d.index-=1,d.$list.find(":eq("+d.index+")").addClass("nui-hvr"))}),d.$element.on("focus.ninja, keyup.ninja",function(b){var c=b.which;d.$element.val()?a.ninja.key(c,["arrowDown","arrowUp","escape","tab"])||(a.isFunction(d.get)?d.get(d.$element.val(),function(a){d.datalist=a,d.list(a)}):d.list(d.datalist)):d.$list.remove()})}})(window.jQuery);