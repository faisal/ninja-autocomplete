/*!
ninja.autocomplete 1.1.4
http://ninjaui.com/autocomplete
Copyright 2008-2012 Jamie Hoover
Licensed per the terms of the Apache License v2.0
http://ninjaui.com/license.txt
*/(function(e){"use strict";e.Ninja.Autocomplete=function(t,n){this.$wrapper=e(t).wrap('<span class="nui-atc">').parent(),this.$list=e("<div>",{css:{top:this.$wrapper.height()-2}}),this.datalist=[],this.matchlist=[],n&&n.get&&(this.get=n.get),this.index=-1},e.Ninja.Autocomplete.prototype.last=function(){return this.matchlist.length-1},e.Ninja.Autocomplete.prototype.list=function(t){var n=this;e.isFunction(n.get)?n.matchlist=t:n.matchlist=e.map(t,function(e){var t=n.$element.val();return t!==e&&(new RegExp("^"+t,"i")).test(e)?e:null}),n.$list.empty(),n.matchlist.length>0&&(e.each(n.matchlist,function(){var t=this;e("<div>",{html:t}).on("hover.ninja",function(){e(this).toggleClass("nui-hvr")}).on("mousedown.ninja",function(){n.$element.val(t)}).appendTo(n.$list)}),n.index=-1,n.$list.appendTo(n.$wrapper))},e.ninja.autocomplete=function(t,n){var r=e.extend(new e.Ninja(t,n),new e.Ninja.Autocomplete(t,n));n&&n.datalist?r.datalist=n.datalist:r.$element.data("list")?r.datalist=r.$element.data("list"):r.$element.attr("list")&&e("datalist#"+r.$element.attr("list")).find("option").each(function(){r.datalist.push(e(this).val())}),r.$element.attr({autocomplete:"off"}).removeAttr("list"),r.$element.on("blur.ninja",function(){r.$list.remove()}),r.$element.on("keydown.ninja",function(t){var n=t.which;e.ninja.key(n,["escape","tab"])?r.$list.remove():n===e.ninja.keys.enter&&r.index>-1?r.$element.val(r.matchlist[r.index]).blur():e.ninja.key(n,["arrowDown","arrowUp"])&&(r.index>-1&&r.$list.find(":eq("+r.index+")").removeClass("nui-hvr"),n===e.ninja.keys.arrowDown?r.index===r.last()?r.index=0:r.index+=1:r.index<=0?r.index=r.last():r.index-=1,r.$list.find(":eq("+r.index+")").addClass("nui-hvr"))}),r.$element.on("focus.ninja, keyup.ninja",function(t){var n=t.which;r.$element.val()?e.ninja.key(n,["arrowDown","arrowUp","escape","tab"])||(e.isFunction(r.get)?r.get(r.$element.val(),function(e){r.datalist=e,r.list(e)}):r.list(r.datalist)):r.$list.remove()})}})(window.jQuery);